(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"2snN":function(t,e,r){"use strict";r.r(e);var o=r("ofXK"),i=r("3Pt+"),n=r("Lw2Y"),d=r("zzOR"),a=r("sVkB"),c=r("fXoL"),b=r("tyNb"),s=r("AwSQ"),l=r("jhRr"),u=r("c8VH"),p=r("HOh6"),h=r("UaFz"),m=r("Jvtu"),S=r("ZOsW"),f=r("Pbud");function g(t,e){if(1&t&&c.Nb(0,"span",41),2&t){const t=c.cc();c.jc("innerHTML",t.formErrors.order_no,c.wc)}}function v(t,e){if(1&t){const t=c.Tb();c.Sb(0,"a",47),c.ac("click",(function(){c.vc(t);const e=c.cc(),r=e.$implicit,o=e.index;return c.cc().editform(null==r?null:r.po_detail_id,o,r)})),c.Nb(1,"i",49),c.Dc(2," Edit"),c.Rb()}}function R(t,e){if(1&t){const t=c.Tb();c.Sb(0,"tr"),c.Sb(1,"td"),c.Dc(2),c.Rb(),c.Sb(3,"td"),c.Dc(4),c.Rb(),c.Sb(5,"td"),c.Dc(6),c.Rb(),c.Sb(7,"td"),c.Dc(8),c.Rb(),c.Sb(9,"td"),c.Dc(10),c.Rb(),c.Sb(11,"td"),c.Dc(12),c.dc(13,"number"),c.Rb(),c.Sb(14,"td"),c.Sb(15,"div",42),c.Sb(16,"a",43),c.Nb(17,"i",44),c.Rb(),c.Sb(18,"div",45),c.Bc(19,v,3,0,"a",46),c.Sb(20,"a",47),c.ac("click",(function(){c.vc(t);const r=e.$implicit,o=e.index;return c.cc().deleteObject(r,o)})),c.Nb(21,"i",48),c.Dc(22," Delete "),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Rb()}if(2&t){const t=e.$implicit,r=e.index,o=c.cc();c.zb(2),c.Ec(r+1),c.zb(2),c.Ec(null==t?null:t.product_name),c.zb(2),c.Ec(null==t?null:t.sku_no),c.zb(2),c.Ec(null==t?null:t.qty),c.zb(2),c.Gc("",null==o.currentCompany?null:null==o.currentCompany.currency?null:o.currentCompany.currency.label," ",null==t?null:t.price,""),c.zb(2),c.Gc("",null==o.currentCompany?null:null==o.currentCompany.currency?null:o.currentCompany.currency.label," ",c.ec(13,9,(null==t?null:t.qty)*(null==t?null:t.price)),""),c.zb(7),c.jc("ngIf",o.isEditing)}}function _(t,e){1&t&&(c.Sb(0,"tr"),c.Sb(1,"td",50),c.Dc(2,"No records found"),c.Rb(),c.Rb())}const y=function(t){return{"has-error":t}};let D=(()=>{class t{constructor(t,e,r,o,n,a,c){this.router=t,this.activatedRoute=e,this.dataservice=r,this.fb=o,this.orderService=n,this.cdr=a,this.paginationService=c,this.PageTitle="Add Order",this.exampleOptions={defaultDate:new Date,dateFormat:d.a},this.supplierListArray=[],this.objectArray=[],this.clientListArray=[],this.loadingState=!1,this.showLoader=!1,this.formErrors={apierror:null,order_no:null},this.isEditing=!1,this.editId=null,this.orderId=!1,this.currentPage=1,this.activatedRoute.snapshot.paramMap.get("id")&&(this.isEditing=!0,this.editId=this.activatedRoute.snapshot.paramMap.get("id")),this.addForm=this.fb.group({po_no:[null,i.t.compose([i.t.required])],po_date:[null,i.t.compose([i.t.required])],supplier_id:[null,i.t.compose([i.t.required])],client_id:[null],notes:[null],invoice_no:[""]})}ngOnInit(){this.dataservice.currentCompany.subscribe(t=>{t&&(this.currentCompany=t)}),this.orderDate=new Date,this.addForm.patchValue({po_date:new Date}),this.getMasterData(),this.isEditing&&(this.getEditObject(),this.getOrderProductList())}getMasterData(){this.orderService.getOrderMasterData().subscribe(t=>{t.success&&(this.supplierListArray=t.data.supplier,this.clientListArray=t.data.client)})}getOrderProductList(){this.orderService.getOrderProductList({order_id:this.editId}).subscribe(t=>{this.loadingState=!1,t.success&&t.data?(this.objectArray=t.data.list,this.pagination=this.paginationService.getPager(t.data.pagination.total_page,this.currentPage)):(this.objectArray=[],this.pagination=null)},t=>{this.loadingState=!1,this.objectArray=[],this.pagination=null})}getEditObject(){this.orderService.getOrderById(this.editId).subscribe(t=>{t.success?(this.orderDate=new Date(t.data.po_date),this.addForm.patchValue({po_no:t.data.po_no,supplier_id:t.data.supplier_id,client_id:t.data.client_id,po_date:t.data.po_date,notes:t.data.notes?t.data.notes:"",invoice_no:t.data.invoice_no})):this.router.navigateByUrl("/inbound/order")})}getPage(t){this.currentPage=t,this.currentPage=1,this.getOrderProductList()}onProductSubmit(t){t&&(t.index?this.objectArray[t.index]=t:this.objectArray.push(t))}submitForm(t){if(t.valid){this.showLoader=!0;const e=new FormData;e.append("po_no",t.value.po_no),e.append("po_date",n.a.changedateFormate(t.value.po_date[0])),e.append("supplier_id",t.value.supplier_id),e.append("client_id",t.value.client_id),e.append("invoice_no",t.value.invoice_no),e.append("notes",t.value.notes?t.value.notes:""),this.isEditing?this.orderService.editOrder(this.editId,e).subscribe(t=>{if(this.showLoader=!1,t.success){if(this.objectArray&&this.objectArray.length>0){let t=[];this.objectArray.filter(e=>{e.po_detail_id||t.push(e)}),t.filter(t=>{t.order_id=this.editId}),this.orderService.addOrderProduct(t).subscribe(t=>{this.showLoader=!1},t=>{this.showLoader=!1})}this.router.navigateByUrl("/inbound/order")}},t=>{this.showLoader=!1}):this.orderService.addOrder(e).subscribe(t=>{if(this.showLoader=!1,t.success){let e=t.data.po_id;this.objectArray&&this.objectArray.length>0&&(this.objectArray.filter(t=>{t.order_id=e}),this.orderService.addOrderProduct(this.objectArray).subscribe(t=>{this.showLoader=!1},t=>{this.showLoader=!1})),this.router.navigateByUrl("/inbound/order")}},t=>{this.showLoader=!1})}}addform(){this.addForm.value.po_no?setTimeout(()=>{this.productAdd.addObject(),this.orderDate=this.addForm.value.po_date},200):this.formErrors.order_no="* Plese Enter Order Number"}editform(t,e,r){setTimeout(()=>{this.productAdd.editObject(t,e,r,this.editId,this.addForm.value.po_no),this.orderDate=this.addForm.value.po_date},200)}onRelodeEvent(t){t&&this.getOrderProductList()}deleteObject(t,e){swal.fire({title:d.b.delete_header_text,text:d.b.delete_smalll_text,icon:d.b.delete_dialogue_type,showCancelButton:!0,confirmButtonText:d.b.delete_confirm_button,cancelButtonText:d.b.delete_cancel_button}).then(r=>{r.value&&(t.po_detail_id?this.orderService.deleteOrderProduct(t.po_detail_id).subscribe(t=>{t.success&&this.getOrderProductList()}):this.objectArray.splice(e,1))}).catch(swal.noop)}removeError(){this.addForm.value.po_no&&(this.formErrors.order_no=null)}ngAfterViewChecked(){this.cdr.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(c.Mb(b.e),c.Mb(b.a),c.Mb(s.a),c.Mb(i.e),c.Mb(l.a),c.Mb(c.h),c.Mb(u.a))},t.\u0275cmp=c.Gb({type:t,selectors:[["app-add-order"]],viewQuery:function(t,e){var r;1&t&&c.Jc(a.a,!0),2&t&&c.sc(r=c.bc())&&(e.productAdd=r.first)},decls:94,vars:23,consts:[[1,"container-fluid"],[1,"page-header"],[1,"row"],[1,"col"],[1,"mr-auto"],[1,"card"],["role","form",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card-body"],[1,"col-7"],[1,"col-6"],[1,"form-group",3,"ngClass"],[1,"control-label","text-md-right"],[1,""],["type","text","placeholder","",1,"form-control",3,"formControl","change"],["class","help-block",3,"innerHTML",4,"ngIf"],[1,"form-group"],[1,"date-picker"],[3,"setDate","formControl","config"],[1,"date-picker-icon"],[1,"fa","fa-calendar"],["bindLabel","label","bindValue","value","placeholder","Select Supplier",3,"formControl","items"],["bindLabel","label","bindValue","value","placeholder","Select Client",3,"formControl","items"],["type","text","placeholder","",1,"form-control",3,"formControl"],[1,"row","mt-5"],[1,"col-7","d-flex","align-items-center"],[1,"col-5","text-right"],["type","button",1,"btn","btn-light",3,"click"],[1,"la","la-plus"],[1,"row","mt-3"],[1,"table-responsive-md"],[1,"table"],["width","80",1,"text-right"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"paginationList","currentPage","onPageChange"],[1,"col-5"],["rows","2",1,"form-control",3,"formControl"],[1,"text-right","border-top","py-4","mt-5","card-footer"],["type","button","routerLink","/inbound/order",1,"btn","btn-light"],["type","submit",1,"btn","btn-secondary","ml-2"],[3,"ProductList","orderNo","onRelodeEvent","onProductSubmit"],[1,"help-block",3,"innerHTML"],[1,"action-drop","dropdown","text-right"],["href","#","data-toggle","dropdown","title","",1,"btn","shadow-none","btn-default","btn-sm","btn-icon-only"],[1,"fa","fa-ellipsis-h"],[1,"dropdown-menu","dropdown-icon-menu","drop-menu-right",2,"width","100px"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"fa","fa-trash","fa-fw","text-primary"],[1,"fa","fa-edit","fa-fw","text-primary"],["colspan","7"]],template:function(t,e){1&t&&(c.Sb(0,"div",0),c.Sb(1,"div",1),c.Sb(2,"div",2),c.Sb(3,"div",3),c.Sb(4,"h2",4),c.Dc(5),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Sb(6,"div",5),c.Sb(7,"form",6),c.ac("ngSubmit",(function(){return e.submitForm(e.addForm)})),c.Sb(8,"div",7),c.Sb(9,"div",2),c.Sb(10,"div",8),c.Sb(11,"div",2),c.Sb(12,"div",9),c.Sb(13,"div",10),c.Sb(14,"label",11),c.Dc(15,"Order No. "),c.Sb(16,"em"),c.Dc(17,"*"),c.Rb(),c.Rb(),c.Sb(18,"div",12),c.Sb(19,"input",13),c.ac("change",(function(){return e.removeError()})),c.Rb(),c.Bc(20,g,1,1,"span",14),c.Rb(),c.Rb(),c.Rb(),c.Sb(21,"div",9),c.Sb(22,"div",15),c.Sb(23,"label",11),c.Dc(24,"Order Date "),c.Sb(25,"em"),c.Dc(26,"*"),c.Rb(),c.Rb(),c.Sb(27,"div",16),c.Nb(28,"ng2-flatpickr",17),c.Sb(29,"span",18),c.Nb(30,"span",19),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Sb(31,"div",2),c.Sb(32,"div",9),c.Sb(33,"div",15),c.Sb(34,"label",11),c.Dc(35,"Supplier "),c.Sb(36,"em"),c.Dc(37,"*"),c.Rb(),c.Rb(),c.Nb(38,"ng-select",20),c.Rb(),c.Rb(),c.Sb(39,"div",9),c.Sb(40,"div",15),c.Sb(41,"label",11),c.Dc(42,"Client"),c.Rb(),c.Nb(43,"ng-select",21),c.Rb(),c.Rb(),c.Rb(),c.Sb(44,"div",2),c.Sb(45,"div",9),c.Sb(46,"div",15),c.Sb(47,"label",11),c.Dc(48,"Invoice No. "),c.Rb(),c.Nb(49,"input",22),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Sb(50,"div",23),c.Sb(51,"div",24),c.Sb(52,"h5"),c.Dc(53,"Product"),c.Rb(),c.Rb(),c.Sb(54,"div",25),c.Sb(55,"button",26),c.ac("click",(function(){return e.addform()})),c.Nb(56,"i",27),c.Dc(57," Add Product "),c.Rb(),c.Rb(),c.Rb(),c.Sb(58,"div",28),c.Sb(59,"div",3),c.Sb(60,"div",29),c.Sb(61,"table",30),c.Sb(62,"thead"),c.Sb(63,"tr"),c.Sb(64,"th"),c.Dc(65,"No."),c.Rb(),c.Sb(66,"th"),c.Dc(67,"Product"),c.Rb(),c.Sb(68,"th"),c.Dc(69,"Sku No"),c.Rb(),c.Sb(70,"th"),c.Dc(71,"Order Quantity"),c.Rb(),c.Sb(72,"th"),c.Dc(73,"Price"),c.Rb(),c.Sb(74,"th"),c.Dc(75,"Total Price"),c.Rb(),c.Sb(76,"th",31),c.Dc(77,"Action"),c.Rb(),c.Rb(),c.Rb(),c.Sb(78,"tbody"),c.Bc(79,R,23,11,"tr",32),c.Bc(80,_,3,0,"tr",33),c.Rb(),c.Rb(),c.Rb(),c.Sb(81,"pagination",34),c.ac("onPageChange",(function(t){return e.getPage(t)})),c.Rb(),c.Rb(),c.Rb(),c.Sb(82,"div",2),c.Sb(83,"div",35),c.Sb(84,"div",15),c.Sb(85,"label",11),c.Dc(86,"Notes"),c.Rb(),c.Nb(87,"textarea",36),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Sb(88,"div",37),c.Sb(89,"button",38),c.Dc(90,"Cancel"),c.Rb(),c.Sb(91,"button",39),c.Dc(92,"Submit"),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Rb(),c.Sb(93,"app-add-product",40),c.ac("onRelodeEvent",(function(t){return e.onRelodeEvent(t)}))("onProductSubmit",(function(t){return e.onProductSubmit(t)})),c.Rb()),2&t&&(c.zb(5),c.Gc("",e.isEditing?"Update":"Create"," ",e.PageTitle,""),c.zb(2),c.jc("formGroup",e.addForm),c.zb(6),c.jc("ngClass",c.nc(21,y,e.formErrors.order_no)),c.zb(6),c.jc("formControl",e.addForm.controls.po_no),c.zb(1),c.jc("ngIf",e.formErrors.order_no),c.zb(8),c.jc("setDate",e.orderDate)("formControl",e.addForm.controls.po_date)("config",e.exampleOptions),c.zb(10),c.jc("formControl",e.addForm.controls.supplier_id)("items",e.supplierListArray),c.zb(5),c.jc("formControl",e.addForm.controls.client_id)("items",e.clientListArray),c.zb(6),c.jc("formControl",e.addForm.controls.invoice_no),c.zb(30),c.jc("ngForOf",e.objectArray),c.zb(1),c.jc("ngIf",!e.loadingState&&0===e.objectArray.length),c.zb(1),c.jc("paginationList",e.pagination)("currentPage",e.currentPage),c.zb(6),c.jc("formControl",e.addForm.controls.notes),c.zb(6),c.jc("ProductList",e.objectArray)("orderNo",e.addForm.value.po_no))},directives:[i.v,i.p,p.a,i.j,o.j,i.c,i.o,i.g,h.a,o.l,m.a,S.a,o.k,f.a,b.f,a.a],pipes:[o.e],encapsulation:2}),t})();var w=r("PCNd"),j=r("Vr6k"),P=r("QSzr"),L=r("DpbK");r.d(e,"AddOrderModule",(function(){return O}));const C=[{path:"",component:D}];let O=(()=>{class t{}return t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({factory:function(e){return new(e||t)},providers:[l.a],imports:[[o.b,b.i.forChild(C),L.a,m.b,i.l,i.s,w.a,S.b,P.a,j.a]]}),t})()}}]);