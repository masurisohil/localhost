function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"6X4u":function(e,t,r){"use strict";r.r(t);var o=r("ofXK"),a=r("tyNb"),i=r("Jvtu"),n=r("3Pt+"),d=r("PCNd"),s=r("ZOsW"),c=r("Vr6k"),l=r("QSzr"),b=r("DpbK"),u=r("Lw2Y"),p=r("zzOR"),f=r("sVkB"),m=r("fXoL"),h=r("n+qO"),S=r("c8VH"),v=r("8cFx"),_=r("HOh6"),g=r("UaFz"),R=r("Pbud");function y(e,t){if(1&e&&m.Nb(0,"span",41),2&e){var r=m.cc();m.ic("innerHTML",r.formErrors.order_no,m.uc)}}function C(e,t){if(1&e){var r=m.Tb();m.Sb(0,"a",47),m.ac("click",(function(){m.tc(r);var e=m.cc(),t=e.$implicit,o=e.index;return m.cc().editform(null==t?null:t.po_detail_id,o,t)})),m.Nb(1,"i",49),m.Bc(2," Edit"),m.Rb()}}function w(e,t){if(1&e){var r=m.Tb();m.Sb(0,"tr"),m.Sb(1,"td"),m.Bc(2),m.Rb(),m.Sb(3,"td"),m.Bc(4),m.Rb(),m.Sb(5,"td"),m.Bc(6),m.Rb(),m.Sb(7,"td"),m.Bc(8),m.Rb(),m.Sb(9,"td"),m.Bc(10),m.Rb(),m.Sb(11,"td"),m.Bc(12),m.dc(13,"number"),m.Rb(),m.Sb(14,"td"),m.Sb(15,"div",42),m.Sb(16,"a",43),m.Nb(17,"i",44),m.Rb(),m.Sb(18,"div",45),m.zc(19,C,3,0,"a",46),m.Sb(20,"a",47),m.ac("click",(function(){m.tc(r);var e=t.$implicit,o=t.index;return m.cc().deleteObject(e,o)})),m.Nb(21,"i",48),m.Bc(22," Delete "),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb()}if(2&e){var o=t.$implicit,a=t.index,i=m.cc();m.zb(2),m.Cc(a+1),m.zb(2),m.Cc(null==o?null:o.product_name),m.zb(2),m.Cc(null==o?null:o.sku_no),m.zb(2),m.Cc(null==o?null:o.qty),m.zb(2),m.Cc(null==o?null:o.price),m.zb(2),m.Dc("$ ",m.ec(13,7,(null==o?null:o.qty)*(null==o?null:o.price)),""),m.zb(7),m.ic("ngIf",i.isEditing)}}function B(e,t){1&e&&(m.Sb(0,"tr"),m.Sb(1,"td",50),m.Bc(2,"No records found"),m.Rb(),m.Rb())}var O,P=function(e){return{"has-error":e}},L=((O=function(){function e(t,r,o,a,i,d){_classCallCheck(this,e),this.router=t,this.activatedRoute=r,this.fb=o,this.salesOrderService=a,this.paginationService=i,this.commonService=d,this.PageTitle="Sales Order",this.exampleOptions={defaultDate:new Date},this.supplierListArray=[],this.countryListArray=[],this.objectArray=[],this.clientListArray=[],this.loadingState=!1,this.showLoader=!1,this.formErrors={apierror:null,order_no:null},this.isEditing=!1,this.editId=null,this.orderId=!1,this.currentPage=1,this.activatedRoute.snapshot.paramMap.get("id")&&(this.isEditing=!0,this.editId=this.activatedRoute.snapshot.paramMap.get("id")),this.addForm=this.fb.group({sales_order_no:[null,n.t.compose([n.t.required])],sales_order_date:[null,n.t.compose([n.t.required])],supplier_id:[null,n.t.compose([n.t.required])],client_id:[null,n.t.compose([n.t.required])],notes:[null],address:[null],country_name:[null],country_id:[null,n.t.compose([n.t.required])],state:[null,n.t.compose([n.t.required])],city:[null,n.t.compose([n.t.required])],street_address:[null,n.t.compose([n.t.required])]})}return _createClass(e,[{key:"ngOnInit",value:function(){this.addForm.patchValue({sales_order_date:new Date}),this.getMasterData(),this.getCountryList(),this.isEditing&&(this.getEditObject(),this.getOrderProductList())}},{key:"getCountryName",value:function(e){this.addForm.patchValue({country_name:e.label})}},{key:"getCountryList",value:function(){var e=this;this.commonService.getCountryList().subscribe((function(t){t.success&&(e.countryListArray=t.data.country_list)}))}},{key:"getMasterData",value:function(){var e=this;this.salesOrderService.getSalesOrderMasterData().subscribe((function(t){t.success&&(e.supplierListArray=t.data.supplier,e.clientListArray=t.data.client)}))}},{key:"getOrderProductList",value:function(){var e=this;this.salesOrderService.getSalesOrderProductList({sales_order_id:this.editId}).subscribe((function(t){e.loadingState=!1,t.success&&t.data?(e.objectArray=t.data.list,e.pagination=e.paginationService.getPager(t.data.pagination.total_page,e.currentPage)):(e.objectArray=[],e.pagination=null)}),(function(t){e.loadingState=!1,e.objectArray=[],e.pagination=null}))}},{key:"getEditObject",value:function(){var e=this;this.salesOrderService.getSalesOrderById(this.editId).subscribe((function(t){t.success?(e.orderDate=t.data.sales_order_date,e.addForm.patchValue({sales_order_no:t.data.sales_order_no,supplier_id:t.data.supplier_id,client_id:t.data.client_id,sales_order_date:t.data.sales_order_date,notes:t.data.notes?t.data.notes:"",country_name:t.data.address.country_name,country_id:t.data.address.country_id,state:t.data.address.state,city:t.data.address.city,street_address:t.data.address.street_address?t.data.address.street_address:""})):e.router.navigateByUrl("/outbound/sales-order")}))}},{key:"getPage",value:function(e){this.currentPage=e,this.currentPage=1,this.getOrderProductList()}},{key:"onProductSubmit",value:function(e){e&&(e.index?this.objectArray[e.index]=e:this.objectArray.push(e))}},{key:"submitForm",value:function(e){var t=this;if(e.valid){this.showLoader=!0;var r=new FormData;r.append("sales_order_no",e.value.sales_order_no),r.append("sales_order_date",u.a.changedateFormate(e.value.sales_order_date[0])),r.append("supplier_id",e.value.supplier_id),r.append("client_id",e.value.client_id),r.append("notes",e.value.notes?e.value.notes:""),r.append("address",JSON.stringify({country_id:e.value.country_id,country_name:e.value.country_name,state:e.value.state,city:e.value.city,street_address:e.value.street_address})),this.isEditing?this.salesOrderService.editSalesOrder(this.editId,r).subscribe((function(e){if(t.showLoader=!1,e.success){if(t.objectArray&&t.objectArray.length>0){var r=[];t.objectArray.filter((function(e){e.sales_order_detail_id||r.push(e)})),r.filter((function(e){e.sales_order_id=t.editId})),t.salesOrderService.addSalesOrderProduct(r).subscribe((function(e){t.showLoader=!1}),(function(e){t.showLoader=!1}))}t.router.navigateByUrl("/outbound/sales-order")}}),(function(e){t.showLoader=!1})):this.salesOrderService.addSalesOrder(r).subscribe((function(e){if(t.showLoader=!1,e.success){var r=e.data.sales_order_id;t.objectArray&&t.objectArray.length>0&&(t.objectArray.filter((function(e){e.sales_order_id=r})),t.salesOrderService.addSalesOrderProduct(t.objectArray).subscribe((function(e){t.showLoader=!1}),(function(e){t.showLoader=!1}))),t.router.navigateByUrl("/outbound/sales-order")}}),(function(e){t.showLoader=!1}))}}},{key:"addform",value:function(){var e=this;this.addForm.value.sales_order_no?setTimeout((function(){e.productAdd.addObject()}),200):this.formErrors.order_no="* Plese Enter Order Number"}},{key:"editform",value:function(e,t,r){var o=this;setTimeout((function(){console.log("object",r),o.productAdd.editObject(e,t,r,o.editId,o.addForm.value.sales_order_no)}),200)}},{key:"onRelodeEvent",value:function(e){e&&(this.getOrderProductList(),this.addForm.patchValue({sales_order_date:new Date}))}},{key:"deleteObject",value:function(e,t){var r=this;swal.fire({title:p.a.delete_header_text,text:p.a.delete_smalll_text,icon:p.a.delete_dialogue_type,showCancelButton:!0,confirmButtonText:p.a.delete_confirm_button,cancelButtonText:p.a.delete_cancel_button}).then((function(o){o.value&&(e.sales_order_detail_id?r.salesOrderService.deleteSalesOrderProduct(e.sales_order_detail_id).subscribe((function(e){e.success&&r.getOrderProductList()})):r.objectArray.splice(t,1))})).catch(swal.noop)}},{key:"removeError",value:function(){this.addForm.value.sales_order_no&&(this.formErrors.order_no=null)}},{key:"ngAfterViewChecked",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||O)(m.Mb(a.e),m.Mb(a.a),m.Mb(n.e),m.Mb(h.a),m.Mb(S.a),m.Mb(v.a))},O.\u0275cmp=m.Gb({type:O,selectors:[["app-add-sales-order"]],viewQuery:function(e,t){var r;1&e&&m.Gc(f.a,!0),2&e&&m.qc(r=m.bc())&&(t.productAdd=r.first)},decls:120,vars:27,consts:[[1,"container-fluid"],[1,"page-header"],[1,"row"],[1,"col"],[1,"mr-auto"],[1,"card"],["role","form",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card-body"],[1,"col-4"],[1,"form-group",3,"ngClass"],[1,"control-label","text-md-right"],[1,""],["type","text","placeholder","",1,"form-control",3,"formControl","change"],["class","help-block",3,"innerHTML",4,"ngIf"],[1,"form-group"],[1,"date-picker"],[3,"setDate","formControl","config"],[1,"date-picker-icon"],[1,"fa","fa-calendar"],["bindLabel","label","bindValue","value","placeholder","Select Client",3,"formControl","items"],["bindLabel","label","bindValue","value","placeholder","Select Supplier",3,"formControl","items"],["bindLabel","label","bindValue","value","placeholder","Select Country",3,"formControl","items","change"],["type","text","placeholder","",1,"form-control",3,"formControl"],[1,"row","mt-5"],[1,"col-7","d-flex","align-items-center"],[1,"col-5","text-right"],["type","button",1,"btn","btn-light",3,"click"],[1,"la","la-plus"],[1,"row","mt-3"],[1,"table-responsive-md"],[1,"table"],["width","80",1,"text-right"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"paginationList","currentPage","onPageChange"],[1,"col-5"],["rows","2",1,"form-control",3,"formControl"],[1,"text-right","border-top","py-4","mt-5","card-footer"],["type","button","routerLink","/outbound/sales-order",1,"btn","btn-light"],["type","submit",1,"btn","btn-secondary","ml-2"],[3,"ProductList","orderNo","onRelodeEvent","onProductSubmit"],[1,"help-block",3,"innerHTML"],[1,"action-drop","dropdown","text-right"],["href","#","data-toggle","dropdown","title","",1,"btn","shadow-none","btn-default","btn-sm","btn-icon-only"],[1,"fa","fa-ellipsis-h"],[1,"dropdown-menu","dropdown-icon-menu","drop-menu-right",2,"width","100px"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"fa","fa-trash","fa-fw","text-primary"],[1,"fa","fa-edit","fa-fw","text-primary"],["colspan","7"]],template:function(e,t){1&e&&(m.Sb(0,"div",0),m.Sb(1,"div",1),m.Sb(2,"div",2),m.Sb(3,"div",3),m.Sb(4,"h2",4),m.Bc(5),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(6,"div",5),m.Sb(7,"form",6),m.ac("ngSubmit",(function(){return t.submitForm(t.addForm)})),m.Sb(8,"div",7),m.Sb(9,"div",2),m.Sb(10,"div",8),m.Sb(11,"div",9),m.Sb(12,"label",10),m.Bc(13,"Order No. "),m.Sb(14,"em"),m.Bc(15,"*"),m.Rb(),m.Rb(),m.Sb(16,"div",11),m.Sb(17,"input",12),m.ac("change",(function(){return t.removeError()})),m.Rb(),m.zc(18,y,1,1,"span",13),m.Rb(),m.Rb(),m.Rb(),m.Sb(19,"div",8),m.Sb(20,"div",14),m.Sb(21,"label",10),m.Bc(22,"Order Date "),m.Sb(23,"em"),m.Bc(24,"*"),m.Rb(),m.Rb(),m.Sb(25,"div",15),m.Nb(26,"ng2-flatpickr",16),m.Sb(27,"span",17),m.Nb(28,"span",18),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(29,"div",8),m.Sb(30,"div",14),m.Sb(31,"label",10),m.Bc(32,"Client "),m.Sb(33,"em"),m.Bc(34,"*"),m.Rb(),m.Rb(),m.Nb(35,"ng-select",19),m.Rb(),m.Rb(),m.Rb(),m.Sb(36,"div",2),m.Sb(37,"div",8),m.Sb(38,"div",14),m.Sb(39,"label",10),m.Bc(40,"Supplier "),m.Sb(41,"em"),m.Bc(42,"*"),m.Rb(),m.Rb(),m.Nb(43,"ng-select",20),m.Rb(),m.Rb(),m.Sb(44,"div",8),m.Sb(45,"div",14),m.Sb(46,"label",10),m.Bc(47,"Country "),m.Sb(48,"em"),m.Bc(49,"*"),m.Rb(),m.Rb(),m.Sb(50,"div",11),m.Sb(51,"ng-select",21),m.ac("change",(function(e){return t.getCountryName(e)})),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(52,"div",8),m.Sb(53,"div",14),m.Sb(54,"label",10),m.Bc(55,"State "),m.Sb(56,"em"),m.Bc(57,"*"),m.Rb(),m.Rb(),m.Sb(58,"div",11),m.Nb(59,"input",22),m.Rb(),m.Rb(),m.Rb(),m.Sb(60,"div",8),m.Sb(61,"div",14),m.Sb(62,"label",10),m.Bc(63,"City "),m.Sb(64,"em"),m.Bc(65,"*"),m.Rb(),m.Rb(),m.Sb(66,"div",11),m.Nb(67,"input",22),m.Rb(),m.Rb(),m.Rb(),m.Sb(68,"div",8),m.Sb(69,"div",14),m.Sb(70,"label",10),m.Bc(71,"Street Address "),m.Sb(72,"em"),m.Bc(73,"*"),m.Rb(),m.Rb(),m.Sb(74,"div",11),m.Nb(75,"input",22),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(76,"div",23),m.Sb(77,"div",24),m.Sb(78,"h5"),m.Bc(79,"Product"),m.Rb(),m.Rb(),m.Sb(80,"div",25),m.Sb(81,"button",26),m.ac("click",(function(){return t.addform()})),m.Nb(82,"i",27),m.Bc(83," Add Product "),m.Rb(),m.Rb(),m.Rb(),m.Sb(84,"div",28),m.Sb(85,"div",3),m.Sb(86,"div",29),m.Sb(87,"table",30),m.Sb(88,"thead"),m.Sb(89,"tr"),m.Sb(90,"th"),m.Bc(91,"No."),m.Rb(),m.Sb(92,"th"),m.Bc(93,"Product"),m.Rb(),m.Sb(94,"th"),m.Bc(95,"Sku No"),m.Rb(),m.Sb(96,"th"),m.Bc(97,"Order Quantity"),m.Rb(),m.Sb(98,"th"),m.Bc(99,"Price"),m.Rb(),m.Sb(100,"th"),m.Bc(101,"Total Price"),m.Rb(),m.Sb(102,"th",31),m.Bc(103,"Action"),m.Rb(),m.Rb(),m.Rb(),m.Sb(104,"tbody"),m.zc(105,w,23,9,"tr",32),m.zc(106,B,3,0,"tr",33),m.Rb(),m.Rb(),m.Rb(),m.Sb(107,"pagination",34),m.ac("onPageChange",(function(e){return t.getPage(e)})),m.Rb(),m.Rb(),m.Rb(),m.Sb(108,"div",2),m.Sb(109,"div",35),m.Sb(110,"div",14),m.Sb(111,"label",10),m.Bc(112,"Notes"),m.Rb(),m.Nb(113,"textarea",36),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(114,"div",37),m.Sb(115,"button",38),m.Bc(116,"Cancel"),m.Rb(),m.Sb(117,"button",39),m.Bc(118,"Submit"),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(119,"app-add-product",40),m.ac("onRelodeEvent",(function(e){return t.onRelodeEvent(e)}))("onProductSubmit",(function(e){return t.onProductSubmit(e)})),m.Rb()),2&e&&(m.zb(5),m.Ec("",t.isEditing?"Update":"Create"," ",t.PageTitle,""),m.zb(2),m.ic("formGroup",t.addForm),m.zb(4),m.ic("ngClass",m.mc(25,P,t.formErrors.order_no)),m.zb(6),m.ic("formControl",t.addForm.controls.sales_order_no),m.zb(1),m.ic("ngIf",t.formErrors.order_no),m.zb(8),m.ic("setDate",t.orderDate)("formControl",t.addForm.controls.sales_order_date)("config",t.exampleOptions),m.zb(9),m.ic("formControl",t.addForm.controls.client_id)("items",t.clientListArray),m.zb(8),m.ic("formControl",t.addForm.controls.supplier_id)("items",t.supplierListArray),m.zb(8),m.ic("formControl",t.addForm.controls.country_id)("items",t.countryListArray),m.zb(8),m.ic("formControl",t.addForm.controls.state),m.zb(8),m.ic("formControl",t.addForm.controls.city),m.zb(8),m.ic("formControl",t.addForm.controls.street_address),m.zb(30),m.ic("ngForOf",t.objectArray),m.zb(1),m.ic("ngIf",!t.loadingState&&0===t.objectArray.length),m.zb(1),m.ic("paginationList",t.pagination)("currentPage",t.currentPage),m.zb(6),m.ic("formControl",t.addForm.controls.notes),m.zb(6),m.ic("ProductList",t.objectArray)("orderNo",t.addForm.value.sales_order_no))},directives:[n.v,n.p,_.a,n.j,o.j,n.c,n.o,n.g,g.a,o.l,i.a,s.a,o.k,R.a,a.f,f.a],pipes:[o.e],encapsulation:2}),O);r.d(t,"AddSalesOrderModule",(function(){return z}));var k,A=[{path:"",component:L}],z=((k=function e(){_classCallCheck(this,e)}).\u0275mod=m.Kb({type:k}),k.\u0275inj=m.Jb({factory:function(e){return new(e||k)},providers:[h.a],imports:[[o.b,a.i.forChild(A),b.a,i.b,n.l,n.s,d.a,s.b,l.a,c.a]]}),k)}}]);